function uploadProfImage(){var e=firebase.auth().currentUser.uid;const t=firebase.storage().ref(e),n=document.querySelector("#profilePicture").files[0],a="prof_pic",o={contentType:n.type};t.child(a).put(n,o).then(t=>t.ref.getDownloadURL().then(t=>{const n={imageUrl:t};return firebase.database().ref(e).push().set(n).then(()=>{console.log("Image uploaded successfully"),document.querySelector("#profilePicture").src=t})}))["catch"](console.error)}function uploadImage(){var e=document.getElementById("userId").value;const t=firebase.storage().ref(e),n=document.querySelector("#photo").files[0],a=+new Date+"-"+n.name,o={contentType:n.type},r=document.querySelector("#description").value,c={day:"2-digit",month:"2-digit",year:"numeric"},d=new Date(document.querySelector("#date").value).toLocaleDateString("de-DE",c);t.child(a).put(n,o).then(t=>t.ref.getDownloadURL().then(t=>{const n={imageUrl:t,description:r,date:d};return firebase.database().ref(e).push().set(n).then(()=>{console.log("Image uploaded successfully"),document.getElementById("status").style.display="block",document.getElementById("loading").style.display="none";document.createElement("li");document.createElement("img").src=t})}))["catch"](console.error)}function openImageSelector(){document.getElementById("collapseSection").style.display="block",document.getElementById("photo").click()}function deleteImage(e,t){var n=firebase.auth().currentUser.uid;firebase.database().ref(n).once("value").then(function(a){a.forEach(function(a){if(a.val().imageUrl===e){var o=firebase.firestore().collection("users").doc(n);o.get().then(function(n){if(n.exists){var r=(n.data().height||0)-t;o.update({height:r}).then(function(){console.log("Height updated successfully")})["catch"](function(e){console.error("Error updating height:",e)}),document.getElementById("height-data").textContent=r,a.ref.remove().then(function(){firebase.storage().refFromURL(e)["delete"]().then(function(){console.log("Image deleted successfully");for(var t=document.getElementById("content-container").getElementsByClassName("figure"),n=0;n<t.length;n++){var a=t[n].querySelector("img");if(a.src===e){var o=a.parentNode.parentNode;o.parentNode.removeChild(o);break}}})["catch"](function(e){console.error("Error deleting image from storage:",e)})})["catch"](function(e){console.error("Error deleting image from database:",e)})}else console.error("User document does not exist")})["catch"](function(e){console.error("Error retrieving user document:",e)})}})})["catch"](console.error)}function showimage_my_profile(){firebase.auth().onAuthStateChanged(e=>{if(e){var t=e.uid,n=(e.displayName,firebase.database().ref(t)),a=document.createElement("div");a.classList.add("container");var o=null,r=0;n.on("value",function(e){var t=[];e.forEach(function(e){var n=e.child("description").val(),a=e.child("imageUrl").val(),o=e.child("date").val();a.includes("prof_pic")||t.push({imageURL:a,description:n,date:o})}),t.sort(function(e,t){return new Date(parseGermanDate(t.date))-new Date(parseGermanDate(e.date))}),displayedImageURLs=[],a.innerHTML="",t.forEach(function(e){var t=e.imageURL,n=e.description,c=e.date;if(-1===displayedImageURLs.indexOf(t)){displayedImageURLs.push(t);var d=document.createElement("div");d.classList.add("col-md-4","mb-3","image-column");var i=document.createElement("a");i.classList.add("image-link");var l=document.createElement("img");l.src=t,l.classList.add("img-fluid","rounded","z-depth-1"),l.setAttribute("alt",n),i.appendChild(l);var s=document.createElement("p");s.innerText=n,s.classList.add("text-center");var u=document.createElement("p");u.innerText="Datum: "+c,u.classList.add("text-center");var m=document.createElement("button");m.innerText="L\xf6schen",m.classList.add("btn","btn-danger","btn-sm","delete-button"),m.addEventListener("click",function(){deleteImage(t,height)});var g=document.createElement("div");g.classList.add("figure","text-center"),g.appendChild(i),g.appendChild(s),g.appendChild(u),g.appendChild(m),d.appendChild(g),r%3==0&&null!==o&&(o=null),null===o&&((o=document.createElement("div")).classList.add("row"),a.appendChild(o)),o.appendChild(d),r++,i.addEventListener("click",function(e){e.preventDefault(),localStorage.setItem("selectedImage",this.querySelector("img").src),window.location.href="/message_details/"})}}),document.getElementById("content-container").appendChild(a);var n=document.createElement("div");n.classList.add("caption"),document.getElementById("content-container").appendChild(n)})}})}function parseGermanDate(e){var t=e.split(".");return 3===t.length?t[1]+"/"+t[0]+"/"+t[2]:e}function getUserData(){firebase.auth().onAuthStateChanged(e=>{if(e){document.getElementById("content").style.display="block",document.getElementById("error-message").style.display="none";var t=e.uid,n=(firebase.firestore().collection("users").doc(t),e.displayName);document.getElementById("username-placeholder").textContent=n}else console.error("User is not signed in"),document.getElementById("content").style.display="none",document.getElementById("error-message").style.display="block"})}function getUserData_only_one(){firebase.auth().onAuthStateChanged(e=>{if(e){if(e=firebase.auth().currentUser){var t=e.uid;firebase.firestore().collection("users").doc(t)}}else console.error("User is not signed in")})}function disableAndExecute(){document.getElementById("upload").disabled=!0,document.getElementById("loading").style.display="block",uploadImage(),setTimeout(function(){document.getElementById("upload").disabled=!1,document.getElementById("loading").style.display="none"},8e3)}function showEnlargedImage(e,t){function n(){o.remove(),document.removeEventListener("keydown",a)}function a(e){"Escape"===e.key&&n()}var o=document.createElement("div");o.classList.add("modal");var r=document.createElement("div");r.classList.add("modal-content");var c=document.createElement("span");c.innerHTML="&times;",c.classList.add("close-button");var d=document.createElement("img");d.src=e,d.classList.add("enlarged-image");var i=document.createElement("p");i.innerText=t,r.appendChild(c),r.appendChild(d),r.appendChild(i),o.appendChild(r),document.body.appendChild(o),o.addEventListener("click",function(e){e.target!==o&&e.target!==c||n()}),document.addEventListener("keydown",a)}function previewImage(){const e=document.querySelector("#preview"),t=document.querySelector("#photo").files[0],n=new FileReader;n.addEventListener("load",function(){e.src=n.result,e.style.display="block"},!1),t?n.readAsDataURL(t):e.style.display="none"}function previewImage_profile(){const e=document.querySelector("#preview_profilePicture"),t=document.querySelector("#profilePicture").files[0],n=new FileReader;n.addEventListener("load",function(){e.src=n.result,e.style.display="block"},!1),t?n.readAsDataURL(t):e.style.display="none"}function removeAccount(){var e=firebase.auth().currentUser,t=e.uid;confirm("Bist du sicher, dass du den Account l\xf6schen willst? Diese Aktion kann nicht r\xfcckg\xe4ngig gemacht werden.")&&firebase.firestore().collection("users").doc(t)["delete"]().then(function(){firebase.database().ref(t).remove().then(function(){firebase.storage().ref(t).listAll().then(function(e){var t=e.items.map(function(e){return e["delete"]()});return Promise.all(t)}).then(function(){return e["delete"]()}).then(function(){alert("Account erfolgreich gel\xf6scht")})["catch"](function(e){console.log(e)})})["catch"](function(e){console.log(e)})})["catch"](function(e){console.log(e)})}function signOut(){firebase.auth().signOut().then(function(){alert("Ausgeloggt")})["catch"](function(e){console.log(e)})}function display_image_container(){var e=localStorage.getItem("selectedImage");if(e){var t=document.createElement("img");t.src=e,t.classList.add("img-fluid","rounded","z-depth-1"),document.getElementById("image-container").appendChild(t)}}var displayedImageURLs=[];const errorMsgElement=document.querySelector("span#errorMsg");